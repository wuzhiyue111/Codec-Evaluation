mode: quantized_emb
sample_rate: 44100
target_sec: 30
n_segments: 6
probe_ckpt_dir: /sdb/model_weight/codec_evaluation/probe_eval/probe_ckpt/emo_dataset/
seed: 666
trainer:
  _target_: pytorch_lightning.Trainer
  accelerator: gpu
  devices:
  - 0
  precision: 32
  max_epochs: 100
  log_every_n_steps: 5
  val_check_interval: 1.0
data:
  _target_: codec_evaluation.probe.dataset.EMO_dataset.EMOdataModule
  dataset:
    _target_: codec_evaluation.probe.dataset.EMO_dataset.EMOdataset
    sample_rate: ${sample_rate}
    target_sec: ${target_sec}
    n_segments: ${n_segments}
    is_mono: true
    is_normalize: true
    audio_dir: /home/wsy/project/MARBLE-Benchmark/data/EM0/emomusic/wav
    meta_dir: /home/wsy/project/MARBLE-Benchmark/data/EM0/emomusic
  batch_size: 64
  val_split: 0.2
  codec_name: dac
model:
  _target_: codec_evaluation.probe.model.lit_prober.Prober
  codec_name: dac
  sample_rate: ${sample_rate}
  mode: ${mode}
  probe_model_builder:
    _target_: codec_evaluation.probe.model.EMO_dataset.model.EMOProber
    _partial_: true
    target_sec: ${target_sec}
    n_segments: ${n_segments}
    channel_reduction: 16
    padding: 1
    kernel_size: 3
    stride: 2
  target_sec: ${target_sec}
  n_segments: ${n_segments}
optimizer_builder:
  _target_: torch.optim.AdamW
  _partial_: true
  lr: 0.0001
  betas:
  - 0.8
  - 0.99
  eps: 1.0e-05
  weight_decay: 0.08
callbacks:
  learning_rate_monitor:
    _target_: lightning.pytorch.callbacks.LearningRateMonitor
    logging_interval: step
  rich_progress_bar:
    _target_: lightning.pytorch.callbacks.RichProgressBar
  model_summary:
    _target_: lightning.pytorch.callbacks.ModelSummary
    max_depth: 1
  _target_: pytorch_lightning.callbacks.ModelCheckpoint
  monitor: val_loss
  dirpath: ${probe_ckpt_dir}
  every_n_epochs: 1
  mode: min
  save_top_k: 1
  save_last: true
  filename: dac_${mode}_{epoch}-{val_loss:.4f}
  verbose: true
tensorboard:
  _target_: lightning.pytorch.loggers.TensorBoardLogger
  save_dir: /sdb/model_weight/codec_evaluation/probe_eval/tensorboard_log/emo_dataset
  name: dac_${mode}
  log_graph: true
